@page
@model Senparc.Areas.Admin.Areas.Admin.Pages.XscfModuleIndexModel
@using Senparc.Scf.Core.Areas;
@using Senparc.Scf.XscfBase;
@{
    ViewData["Title"] = "模块管理"; Layout = "_Layout_Vue";
}
@section Style{
    <link href="~/css/Admin/XscfModule/XscfModule.css" rel="stylesheet" />
}
@section breadcrumbs {
    <el-breadcrumb-item>扩展模块</el-breadcrumb-item>
    <el-breadcrumb-item>模块管理</el-breadcrumb-item>
}
<div id="app" v-cloak>
    <div class="filter-container">
        <el-popconfirm class="float-right" placement="top" :title="handlerTips" @@on-confirm="handleSwitch">
            <el-button size="mini" type="danger" slot="reference">{{handlerText}}</el-button>
        </el-popconfirm>
    </div>
    <template v-if="newTableData.length>0">
        <h3>发现新模块！</h3>
        <el-table :data="newTableData"
                  style="width: 100%;margin-bottom: 20px;">
            <el-table-column align="left" label="模块名称">
                <template slot-scope="scope">
                    <i class="fa fa-cubes"></i>
                    {{scope.row.name}}
                </template>
            </el-table-column>
            <el-table-column align="center" label="菜单名称（显示名称）">
                <template slot-scope="scope">
                    <i :class="scope.row.icon"></i>
                    {{scope.row.menuName}}

                </template>
            </el-table-column>
            <el-table-column align="center" label="版本号">
                <template slot-scope="scope">
                    <i class="fa fa-code-fork"></i>
                    {{scope.row.version}}
                </template>
            </el-table-column>
            <el-table-column align="center" label="唯一编码（全局唯一）">
                <template slot-scope="scope">
                    <i class="fa fa-shield"></i>
                    {{scope.row.uid}}
                </template>
            </el-table-column>
            <el-table-column label="操作" align="center">
                <template slot-scope="scope">
                    <el-button size="mini"
                               type="primary"
                               icon="el-icon-circle-plus"
                               @@click="handleInstall(scope.$index, scope.row)">安装</el-button>
                </template>
            </el-table-column>
        </el-table>
    </template>
    <template v-if="oldTableData.length>0">
        <h3>已安装模块</h3>
        <el-table :data="oldTableData"
                  v-if="oldTableData.length>0"
                  style="width: 100%;margin-bottom: 20px;">
            <el-table-column align="left" label="菜单名称/版本号">
                <template slot-scope="scope">
                    <div>
                        <i :class="scope.row.xscfRegister.icon"></i>
                        {{scope.row.xscfModule.menuName}}
                    </div>
                    <div>
                        <i class="fa fa-code-fork"></i>
                        v{{scope.row.xscfModule.version}}
                    </div>
                </template>
            </el-table-column>
            <el-table-column align="center" label="模块名称/唯一编码（全局唯一）">
                <template slot-scope="scope">
                    <div>
                        <i class="fa fa-cubes"></i>
                        {{scope.row.xscfModule.name}}
                    </div>
                    <div>
                        <i class="fa fa-shield"></i>
                        {{scope.row.xscfModule.uid}}
                    </div>
                </template>
            </el-table-column>
            <el-table-column align="center" label="状态">
                <template slot-scope="scope">
                    {{oldData.state[scope.row.xscfModule.state]}}
                </template>
            </el-table-column>
            <el-table-column align="center" label="添加时间">
                <template slot-scope="scope">
                    {{formaTableTime(scope.row.xscfModule.addTime)}}
                </template>
            </el-table-column>
            <el-table-column label="操作" align="center">
                <template slot-scope="scope">
                    <el-button size="mini"
                               icon="el-icon-s-tools"
                               type="primary"
                               @@click="handleHandle(scope.$index, scope.row)">操作</el-button>
                    <el-button size="mini"
                               v-if="scope.row.xscfRegister.homeUrl"
                               icon="el-icon-s-home"
                               type="primary"
                               @@click="handleIndex(scope.$index, scope.row)">主页</el-button>
                </template>
            </el-table-column>
        </el-table>
    </template>

</div>
@section scripts{
    <script src="~/js/Admin/Pages/XscfModule/Index.js"></script>
}
